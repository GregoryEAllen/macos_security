id: sysprefs_firewall_block_all
title: "Enable macOS Application Firewall block all"
discussion: |
  The macOS Application Firewall is the built-in firewall that comes with macOS, and it _MUST_ be enabled and configured to block all non-essential incoming connections.

  When the macOS Application Firewall is enabled, the flow of information within the information system and between interconnected systems will be controlled by approved authorizations. For systems with higher security requirements, all non-essential incoming connections should be blocked.
check: |
  /usr/libexec/ApplicationFirewall/socketfilterfw --getblockall | /usr/bin/grep -c "Firewall is set to block all non-essential incoming connections"
result:
  integer: 1
fix: |
  [source,bash]
  ----
  /usr/libexec/ApplicationFirewall/socketfilterfw --setblockall on
  ----
references:
  cce:
    - n/a
  cci: 
    - n/a
  800-53r4: 
    - AC-4
    - AC-6(1)
    - AC-19
    - SC-7
    - CM-7
    - SC-7(12)
  srg:
    - n/a
  disa_stig: 
    - n/a
  800-171r2:
    - n/a
macOS:
  - "11.0"
tags:
  - 800-179_sslf
  - preliminary
mobileconfig: false
mobileconfig_info:
